{% load static %}

{% block extra_css %}
  <link href="{% static 'scheduler/css/jquery.datetimepicker.css' %}" rel='stylesheet' />
{% endblock %}

{% block extra_js %}
  <script src="{% static 'scheduler/js/jquery.datetimepicker.full.js' %}"></script>
{% endblock %}

  <!-- Modal Trigger -->
  <!-- <a class="waves-effect waves-light btn modal-trigger" href="#modal1">Modal</a> -->

  <!-- Modal Structure -->
<!--   <div id="modal1" class="modal">
    <div class="modal-content">
 -->
 <div id="modal1">
   
      <button data-formType="appointment" id="switch_form">Schedule Event</button>

        <form id="appointment_form" class="active" action="." method="POST">
            {% csrf_token %}

            {{ forms.appointment.as_p }}

            <p><input type="submit" value="Schedule"></p>
        </form>

        <form id="event_form" class="hidden" action="." method="POST">
            {% csrf_token %}

            {{ forms.event.as_p }}

            <p><input type="submit" value="Schedule"></p>
        </form>
 </div>

<!--     </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-green btn-flat">Agree</a>
    </div>
  </div> -->

<!-- TODO: start/end for event should be conditional
  if all day unchecked, show start / end
https://www.fusionbox.com/blog/detail/creating-conditionally-required-fields-in-django-forms/577/
-->

<!-- TODO: place CSS and Scripts in folders. Use \{\% extra js \%\} in this template -->
<style type="text/css">
  .hidden {
    height: 0px;
    visibility: hidden;
  }
  .active .hidden {
    visibility: visible;
  }
</style>

<script>
  $(function () {
    $("#id_datetime").datetimepicker({
      format: 'd/m/Y H:i',
    });
  });
</script>


<script type="text/javascript">
  var reverse_of = {'appointment': 'event', 'event': 'appointment'};
  var active_form = 'appointment';
  var inactive_form = 'event';

  document.getElementById('switch_form').addEventListener('click', function() {
    console.log(this.dataset.formtype);

    inactive_form = this.dataset.formtype;
    active = reverse_of[this.dataset.formtype];

    document.getElementById(inactive_form + '_form').classList.remove('active');
    document.getElementById(inactive_form + '_form').classList.add('hidden');
    document.getElementById(active_form + '_form').classList.remove('hidden');
    document.getElementById(active_form + '_form').classList.add('active');

    this.dataset.formtype = active_form;
    this.innerHTML = 'Schedule ' + inactive_form.charAt(0).toUpperCase() + inactive_form.slice(1);
  });
</script>

<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
    var options = {};
    var elems = document.querySelectorAll('.modal');
    var instances = M.Modal.init(elems, options);
  })
</script>